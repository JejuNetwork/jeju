# Bun configuration for Bazaar

[serve.static]
# TailwindCSS plugin
plugins = ["bun-plugin-tailwind"]

# Inline environment variables with PUBLIC_ prefix
env = "PUBLIC_*"

[build]
# External packages that shouldn't be bundled (server-only)
external = [
  "@jejunetwork/db",
  "bun:sqlite",
  "child_process",
  "http2",
  "tls",
  "dgram",
  "google-gax",
  "google-auth-library",
  "@grpc/grpc-js",
  "native-dns",
  "native-dns-cache"
]

[test]
# Preload shared test infrastructure - ensures jeju CLI is running
preload = ["@jejunetwork/tests/bun-global-setup"]
coverage = true
coverageDir = "./test-results/coverage"
timeout = 60000
# Only run Bun tests. Playwright/Synpress suites run via `jeju test --mode e2e`.
#
# Bun tests live in:
# - tests/unit, tests/integration
# - api/**/__tests__
# - web/**/__tests__
#
# Intentionally exclude tests/playwright + tests/e2e + tests/wallet from Bun.
root = ["api/", "web/", "tests/unit", "tests/integration"]
